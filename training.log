2020-06-23 12:11:11,678 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,679 Model: "TextClassifier(
  (document_embeddings): DocumentRNNEmbeddings(
    (embeddings): StackedEmbeddings(
      (list_embedding_0): ELMoEmbeddings(model=0-elmo-original)
    )
    (word_reprojection_map): Linear(in_features=3072, out_features=256, bias=True)
    (rnn): LSTM(256, 512, batch_first=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (decoder): Linear(in_features=512, out_features=3, bias=True)
  (loss_function): CrossEntropyLoss()
)"
2020-06-23 12:11:11,680 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,682 Corpus: "Corpus: 100 train + 3000 dev + 3000 test sentences"
2020-06-23 12:11:11,682 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,683 Parameters:
2020-06-23 12:11:11,684  - learning_rate: "0.1"
2020-06-23 12:11:11,684  - mini_batch_size: "32"
2020-06-23 12:11:11,685  - patience: "5"
2020-06-23 12:11:11,686  - anneal_factor: "0.5"
2020-06-23 12:11:11,687  - max_epochs: "15"
2020-06-23 12:11:11,687  - shuffle: "True"
2020-06-23 12:11:11,688  - train_with_dev: "False"
2020-06-23 12:11:11,688  - batch_growth_annealing: "False"
2020-06-23 12:11:11,689 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,689 Model training base path: "."
2020-06-23 12:11:11,690 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,691 Device: cuda:0
2020-06-23 12:11:11,692 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,693 Embeddings storage mode: cpu
2020-06-23 12:11:11,696 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:11,945 epoch 1 - iter 0/4 - loss 1.20414293 - samples/sec: 129.35
2020-06-23 12:11:12,243 epoch 1 - iter 1/4 - loss 0.90223247 - samples/sec: 112.48
2020-06-23 12:11:12,467 epoch 1 - iter 2/4 - loss 0.88235418 - samples/sec: 146.83
2020-06-23 12:11:12,535 epoch 1 - iter 3/4 - loss 0.85789797 - samples/sec: 520.09
2020-06-23 12:11:12,546 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:12,547 EPOCH 1 done: loss 0.8579 - lr 0.1000
2020-06-23 12:11:31,969 DEV : loss 0.6743201017379761 - score 0.7667
2020-06-23 12:11:32,118 BAD EPOCHS (no improvement): 0
2020-06-23 12:11:33,207 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:33,268 epoch 2 - iter 0/4 - loss 0.66289943 - samples/sec: 545.88
2020-06-23 12:11:33,315 epoch 2 - iter 1/4 - loss 0.71299613 - samples/sec: 795.10
2020-06-23 12:11:33,371 epoch 2 - iter 2/4 - loss 0.71684919 - samples/sec: 684.60
2020-06-23 12:11:33,392 epoch 2 - iter 3/4 - loss 0.59646435 - samples/sec: 3026.13
2020-06-23 12:11:33,398 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:33,399 EPOCH 2 done: loss 0.5965 - lr 0.1000
2020-06-23 12:11:35,585 DEV : loss 0.9560748934745789 - score 0.7667
2020-06-23 12:11:35,735 BAD EPOCHS (no improvement): 1
2020-06-23 12:11:36,845 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:36,892 epoch 3 - iter 0/4 - loss 1.06638706 - samples/sec: 708.91
2020-06-23 12:11:36,936 epoch 3 - iter 1/4 - loss 0.81120336 - samples/sec: 849.45
2020-06-23 12:11:36,986 epoch 3 - iter 2/4 - loss 0.72470025 - samples/sec: 785.00
2020-06-23 12:11:37,004 epoch 3 - iter 3/4 - loss 0.71649539 - samples/sec: 2996.47
2020-06-23 12:11:37,012 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:37,013 EPOCH 3 done: loss 0.7165 - lr 0.1000
2020-06-23 12:11:39,149 DEV : loss 0.8111155033111572 - score 0.631
2020-06-23 12:11:39,297 BAD EPOCHS (no improvement): 2
2020-06-23 12:11:39,299 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:39,340 epoch 4 - iter 0/4 - loss 0.76813394 - samples/sec: 817.70
2020-06-23 12:11:39,382 epoch 4 - iter 1/4 - loss 0.81273243 - samples/sec: 933.07
2020-06-23 12:11:39,425 epoch 4 - iter 2/4 - loss 0.70051227 - samples/sec: 931.25
2020-06-23 12:11:39,441 epoch 4 - iter 3/4 - loss 0.69557489 - samples/sec: 3500.08
2020-06-23 12:11:39,447 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:39,448 EPOCH 4 done: loss 0.6956 - lr 0.1000
2020-06-23 12:11:41,565 DEV : loss 0.6557310819625854 - score 0.7683
2020-06-23 12:11:41,731 BAD EPOCHS (no improvement): 0
2020-06-23 12:11:42,833 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:42,881 epoch 5 - iter 0/4 - loss 0.66722411 - samples/sec: 696.31
2020-06-23 12:11:42,930 epoch 5 - iter 1/4 - loss 0.62760797 - samples/sec: 766.66
2020-06-23 12:11:42,979 epoch 5 - iter 2/4 - loss 0.53885423 - samples/sec: 766.43
2020-06-23 12:11:42,999 epoch 5 - iter 3/4 - loss 0.41703378 - samples/sec: 2378.14
2020-06-23 12:11:43,011 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:43,012 EPOCH 5 done: loss 0.4170 - lr 0.1000
2020-06-23 12:11:45,185 DEV : loss 0.8837898373603821 - score 0.7667
2020-06-23 12:11:45,336 BAD EPOCHS (no improvement): 1
2020-06-23 12:11:45,338 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:45,379 epoch 6 - iter 0/4 - loss 0.42848402 - samples/sec: 803.78
2020-06-23 12:11:45,432 epoch 6 - iter 1/4 - loss 0.43746033 - samples/sec: 755.74
2020-06-23 12:11:45,486 epoch 6 - iter 2/4 - loss 0.51768221 - samples/sec: 724.50
2020-06-23 12:11:45,506 epoch 6 - iter 3/4 - loss 0.51532897 - samples/sec: 2558.53
2020-06-23 12:11:45,518 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:45,518 EPOCH 6 done: loss 0.5153 - lr 0.1000
2020-06-23 12:11:47,666 DEV : loss 0.7422454953193665 - score 0.762
2020-06-23 12:11:47,818 BAD EPOCHS (no improvement): 2
2020-06-23 12:11:47,820 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:47,863 epoch 7 - iter 0/4 - loss 0.43892893 - samples/sec: 753.98
2020-06-23 12:11:47,906 epoch 7 - iter 1/4 - loss 0.48589431 - samples/sec: 881.18
2020-06-23 12:11:47,962 epoch 7 - iter 2/4 - loss 0.47941092 - samples/sec: 698.42
2020-06-23 12:11:47,980 epoch 7 - iter 3/4 - loss 0.51877470 - samples/sec: 2604.20
2020-06-23 12:11:47,990 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:47,991 EPOCH 7 done: loss 0.5188 - lr 0.1000
2020-06-23 12:11:50,321 DEV : loss 0.7190904021263123 - score 0.6867
2020-06-23 12:11:50,473 BAD EPOCHS (no improvement): 3
2020-06-23 12:11:50,475 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:50,519 epoch 8 - iter 0/4 - loss 0.46482453 - samples/sec: 760.36
2020-06-23 12:11:50,565 epoch 8 - iter 1/4 - loss 0.50770257 - samples/sec: 797.52
2020-06-23 12:11:50,611 epoch 8 - iter 2/4 - loss 0.51658764 - samples/sec: 816.38
2020-06-23 12:11:50,630 epoch 8 - iter 3/4 - loss 0.59829160 - samples/sec: 2770.12
2020-06-23 12:11:50,640 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:50,642 EPOCH 8 done: loss 0.5983 - lr 0.1000
2020-06-23 12:11:52,840 DEV : loss 0.6248732209205627 - score 0.7617
2020-06-23 12:11:52,992 BAD EPOCHS (no improvement): 4
2020-06-23 12:11:52,993 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:53,038 epoch 9 - iter 0/4 - loss 0.36454827 - samples/sec: 733.75
2020-06-23 12:11:53,079 epoch 9 - iter 1/4 - loss 0.46936584 - samples/sec: 922.08
2020-06-23 12:11:53,125 epoch 9 - iter 2/4 - loss 0.48682449 - samples/sec: 825.96
2020-06-23 12:11:53,143 epoch 9 - iter 3/4 - loss 0.61242469 - samples/sec: 2963.52
2020-06-23 12:11:53,152 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:53,153 EPOCH 9 done: loss 0.6124 - lr 0.1000
2020-06-23 12:11:55,438 DEV : loss 0.6891040205955505 - score 0.7567
2020-06-23 12:11:55,596 BAD EPOCHS (no improvement): 5
2020-06-23 12:11:55,598 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:55,651 epoch 10 - iter 0/4 - loss 0.38801077 - samples/sec: 622.29
2020-06-23 12:11:55,698 epoch 10 - iter 1/4 - loss 0.60337068 - samples/sec: 823.19
2020-06-23 12:11:55,750 epoch 10 - iter 2/4 - loss 0.56467705 - samples/sec: 699.53
2020-06-23 12:11:55,768 epoch 10 - iter 3/4 - loss 0.50210713 - samples/sec: 3839.84
2020-06-23 12:11:55,773 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:55,775 EPOCH 10 done: loss 0.5021 - lr 0.1000
2020-06-23 12:11:58,102 DEV : loss 0.7401565313339233 - score 0.7427
2020-06-23 12:11:58,254 BAD EPOCHS (no improvement): 6
2020-06-23 12:11:58,256 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:58,301 epoch 11 - iter 0/4 - loss 0.14935362 - samples/sec: 734.05
2020-06-23 12:11:58,353 epoch 11 - iter 1/4 - loss 0.24851379 - samples/sec: 806.61
2020-06-23 12:11:58,404 epoch 11 - iter 2/4 - loss 0.31810519 - samples/sec: 715.36
2020-06-23 12:11:58,423 epoch 11 - iter 3/4 - loss 0.25857040 - samples/sec: 2666.54
2020-06-23 12:11:58,436 ----------------------------------------------------------------------------------------------------
2020-06-23 12:11:58,437 EPOCH 11 done: loss 0.2586 - lr 0.0500
2020-06-23 12:12:00,666 DEV : loss 0.7216285467147827 - score 0.7317
2020-06-23 12:12:00,817 BAD EPOCHS (no improvement): 1
2020-06-23 12:12:00,818 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:00,866 epoch 12 - iter 0/4 - loss 0.35808074 - samples/sec: 696.08
2020-06-23 12:12:00,919 epoch 12 - iter 1/4 - loss 0.26929829 - samples/sec: 717.05
2020-06-23 12:12:00,973 epoch 12 - iter 2/4 - loss 0.26751319 - samples/sec: 708.77
2020-06-23 12:12:00,999 epoch 12 - iter 3/4 - loss 0.31003175 - samples/sec: 2217.23
2020-06-23 12:12:01,006 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:01,007 EPOCH 12 done: loss 0.3100 - lr 0.0500
2020-06-23 12:12:03,293 DEV : loss 0.7280484437942505 - score 0.728
2020-06-23 12:12:03,440 BAD EPOCHS (no improvement): 2
2020-06-23 12:12:03,442 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:03,480 epoch 13 - iter 0/4 - loss 0.25505537 - samples/sec: 868.18
2020-06-23 12:12:03,534 epoch 13 - iter 1/4 - loss 0.19914441 - samples/sec: 764.66
2020-06-23 12:12:03,584 epoch 13 - iter 2/4 - loss 0.24425759 - samples/sec: 774.43
2020-06-23 12:12:03,602 epoch 13 - iter 3/4 - loss 0.29874956 - samples/sec: 2942.53
2020-06-23 12:12:03,609 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:03,610 EPOCH 13 done: loss 0.2987 - lr 0.0500
2020-06-23 12:12:05,907 DEV : loss 0.8158363699913025 - score 0.651
2020-06-23 12:12:06,058 BAD EPOCHS (no improvement): 3
2020-06-23 12:12:06,060 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:06,103 epoch 14 - iter 0/4 - loss 0.41772574 - samples/sec: 771.78
2020-06-23 12:12:06,154 epoch 14 - iter 1/4 - loss 0.39245951 - samples/sec: 742.29
2020-06-23 12:12:06,214 epoch 14 - iter 2/4 - loss 0.33568568 - samples/sec: 660.50
2020-06-23 12:12:06,232 epoch 14 - iter 3/4 - loss 0.29322932 - samples/sec: 2817.75
2020-06-23 12:12:06,239 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:06,240 EPOCH 14 done: loss 0.2932 - lr 0.0500
2020-06-23 12:12:08,641 DEV : loss 0.7243504524230957 - score 0.73
2020-06-23 12:12:08,791 BAD EPOCHS (no improvement): 4
2020-06-23 12:12:08,793 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:08,838 epoch 15 - iter 0/4 - loss 0.21455526 - samples/sec: 727.92
2020-06-23 12:12:08,885 epoch 15 - iter 1/4 - loss 0.24852189 - samples/sec: 800.11
2020-06-23 12:12:08,935 epoch 15 - iter 2/4 - loss 0.22961415 - samples/sec: 802.77
2020-06-23 12:12:08,953 epoch 15 - iter 3/4 - loss 0.27842950 - samples/sec: 2984.01
2020-06-23 12:12:08,965 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:08,966 EPOCH 15 done: loss 0.2784 - lr 0.0500
2020-06-23 12:12:11,194 DEV : loss 0.6957404017448425 - score 0.7187
2020-06-23 12:12:11,344 BAD EPOCHS (no improvement): 5
2020-06-23 12:12:12,514 ----------------------------------------------------------------------------------------------------
2020-06-23 12:12:12,515 Testing using best model ...
2020-06-23 12:12:12,517 loading file best-model.pt
2020-06-23 12:12:29,255 0.7667	0.7667	0.7667
2020-06-23 12:12:29,256 
MICRO_AVG: acc 0.6216 - f1-score 0.7667
MACRO_AVG: acc 0.2717 - f1-score 0.3208666666666667
0          tp: 0 - fp: 0 - fn: 173 - tn: 2827 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000
1          tp: 2272 - fp: 693 - fn: 7 - tn: 28 - precision: 0.7663 - recall: 0.9969 - accuracy: 0.7645 - f1-score: 0.8665
2          tp: 28 - fp: 7 - fn: 520 - tn: 2445 - precision: 0.8000 - recall: 0.0511 - accuracy: 0.0505 - f1-score: 0.0961
2020-06-23 12:12:29,257 ----------------------------------------------------------------------------------------------------
